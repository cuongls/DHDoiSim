@model IEnumerable<DHDoiSim.Models.ThongKeOutBound>

@{
    /**/
    ViewBag.Title = "Index";
}

<h2>Tổng hợp OutBound cá nhân</h2>

@*<p>
            @Html.ActionLink("Create New", "Create")
    </p>*@

@*ThaiHN thêm*@
@using (Html.BeginForm("ThongKeOutBound", "ThongKes", FormMethod.Get))
{
    @*@Html.Hidden("NguoiGoi", "");*@
    <div class="row">
        <div class="col-md-2">
            Chọn Nhóm
        </div>
        <div class="col-md-2">
            @Html.DropDownList("Nhom", (IEnumerable<SelectListItem>)ViewData["DSNhom"],
            new { onchange = "OnOutBoundChange(this.value)" })
        </div>
    </div>

    <div class="row">

        <div class="col-md-2">
            Từ ngày (m/d/yyyy)
        </div>

        <div class="col-md-2 TuNgay">
            @Html.TextBox("TuNgay", null, new { @class = "input-small" })

        </div>

        <div class="col-md-2">
            Đến ngày
        </div>

        <div class="col-md-2 DenNgay">
            @Html.TextBox("DenNgay", null, new { @class = "input-small" })
        </div>

        <div class="col-md-2">
            <button type="submit" class="btn btn-info">
                <span class="glyphicon glyphicon-search"></span>
                <span class="submit-text">&nbsp;&nbsp;Xem</span>
            </button>
        </div>

    </div>
}
@*Hết thêm*@

<table class="table table-bordered" id="tableData">
    <tr style="background-color:lightsteelblue;">
        <th style="text-align:center" rowspan="2">
            Xem chi tiết
        </th>
        <th style="text-align:center" rowspan="2">
            UserName
        </th>
        <th style="text-align:center" rowspan="2">
            Họ tên
        </th>
        <th style="text-align:center" colspan="8">
            Gọi Outbound
        </th>
        <th rowspan="2" style="text-align:center; font-weight:700">
            Tổng cuộc gọi
        </th>
        <th style="text-align:center" colspan="6">
            Số phiếu xuất cho các phòng
        </th>
        <th rowspan="2" style="text-align:center; font-weight:700">
            Tổng phiếu
        </th>
    </tr>
    <tr>
        <th style="text-align:center">
            Đang gọi
        </th>
        <th style="text-align:center">
            KH Đồng ý ĐS
        </th>
        <th style="text-align:center">
            KH không ĐY ĐS
        </th>
        <th style="text-align:center">
            Đã gọi chưa có KQ
        </th>
        <th style="text-align:center">
            Không LL được
        </th>
        <th style="text-align:center">
            KH tự ĐS
        </th>
        <th style="text-align:center">
            KH chuyển tỉnh
        </th>
        <th style="text-align:center">
            KH Đã ĐS
        </th>
        <th style="text-align:center">
            P. Tổng hớp
        </th>
        <th style="text-align:center">
            P. Kỹ thuật
        </th>
        <th style="text-align:center">
            P. Vô tuyến
        </th>
        <th style="text-align:center">
            P. VIP
        </th>
        <th style="text-align:center">
            P. KTHT
        </th>
        <th style="text-align:center">
            Phòng HT
        </th>
    </tr>

    @foreach (var item in Model)
    {
        <tr style="text-align:center">
            <td>
                <a href="@Url.Action("ThongKeOutBound", "ThongKes",  new {UserName = item.UserName,item.TuNgay,item.DenNgay})">
                    Chi tiết
                </a>
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.UserName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.HoTen)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.DangGoi)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KHDongYDS)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KHKhongDYDS)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.DaGoiChuaCoKQ)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KhongLLDuoc)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KHTuDS)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KHChuyenTinh)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.KHDaDS)
            </td>
            <td style="text-align:center; font-weight:700">
                @Html.DisplayFor(modelItem => item.TongCuocGoi)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PTH)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PKT)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PVT)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PVIP)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PKTHT)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.PHT)
            </td>
            <td style="text-align:center; font-weight:700">
                @Html.DisplayFor(modelItem => item.PhieuDaXuat)
            </td>
        </tr>
    }
    <tr style="background-color:lightsteelblue;text-align:center">
        <td colspan="3">
            Tổng cộng
        </td>

        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.DangGoi)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KHDongYDS)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KHKhongDYDS)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.DaGoiChuaCoKQ)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KhongLLDuoc)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KHTuDS)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KHChuyenTinh)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.KHDaDS)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.TongCuocGoi)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PTH)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PKT)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PVT)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PVIP)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PKTHT)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PHT)
        </td>
        <td style="text-align:center; font-weight:700">
            @Model.Sum(b => b.PhieuDaXuat)
        </td>
    </tr>
</table>
<link href="~/Content/jquery.datetimepicker.css" rel="stylesheet" />
@section Scripts{
    <script src="~/Scripts/jquery.datetimepicker.js"></script>
    <script type="text/javascript">
        $(function () {
            // This will make every element with the class "date-picker" into a DatePicker element
            $('.date-picker').datepicker();
        })
        $(document).ready(function () {
            $('.TuNgay input').datetimepicker(
                {
                    format: 'm/d/Y',
                    //value: new Date()
                }
            );
        });
        $(document).ready(function () {
            $('.DenNgay input').datetimepicker(
                {
                    format: 'm/d/Y',
                    //value: new Date()
                }
            );
        });
        function getFormattedDate(date) {
            var day = date.getDate();
            var month = date.getMonth() + 1;
            var year = date.getFullYear().toString().slice(2);
            return day + '-' + month + '-' + year;
        }
    </script>
}
@*<h4>Chi tiết gọi hẹn đổi, KH đồng ý đổi sim</h4>
    <table class="table table-bordered" id="tableData">
        <tr style="background-color:lightsteelblue;">
            <th>
                STT
            </th>
            <th>
                Người gọi
            </th>
            <th>
                Số ĐT
            </th>
            <th>
                Giờ Gọi
            </th>
            <th>
                Giờ hẹn
            </th>
            <th>
                Kết quả thực hiện
            </th>
            <th>
                Địa chỉ hẹn đổi sim
            </th>
            <th>
                Quận huyện hẹn đổi sim
            </th>
            <th>
                Phường xã hẹn đổi sim
            </th>
        </tr>

        @{int rowNo = 0;}
        @foreach (var item in ViewBag.list_GoiHenDoiSim4G_XuatPhieuDoiSim)
        {
            <tr>
                <td>
                    @(rowNo += 1)
                </td>

                <td>
                    @item.NguoiGoi
                </td>

                <td>
                    @item.SoDT
                </td>

                <td>
                    @item.GioGoi
                </td>

                <td>
                    @item.GioHen
                </td>

                <td>
                    @item.DMKetQuaThucHien.StatusName
                </td>

                <td>
                    @item.DiaChiHenDoiSim
                </td>

                <td>
                    @item.QHHenDoiSim
                </td>

                <td>
                    @item.PXHenDoiSim
                </td>
            </tr>
        }
    </table>*@

